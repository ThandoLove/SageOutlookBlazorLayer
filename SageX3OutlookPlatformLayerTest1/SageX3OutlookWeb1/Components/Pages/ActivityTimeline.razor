@page "/timeline"
@using SageX3OutlookApplication.DTOs
@using SageX3OutlookWeb1.Apiservices
@inject IApiClient ApiClient

<h3>Activity Timeline</h3>

@if (_loading)
{
    <p>Loading activity...</p>
}
else
{
    <ul class="list-group">
        @foreach (var log in _logs)
        {
            <li class="list-group-item">
                <strong>@log.Type</strong> - @log.Description
                <div class="text-muted small">@log.CreatedAt</div>
            </li>
        }
    </ul>
}

@code {
    private List<AuditLogDto> _logs = new();
    private bool _loading = true;

    protected override async Task OnInitializedAsync()
    {
        // Added 'default' to match the CancellationToken requirement
        _logs = await ApiClient.GetAuditLogsAsync(default);
        _loading = false;
    }
}
